/**
* http://yootil.pixeldepth.net - 0.9.0
*/
yootil=function(){return!$.support.cors&&$.ajaxTransport&&window.XDomainRequest&&$.ajaxTransport("json",function(e,t,n){if(e.crossDomain){var r=null;return{send:function(t,n){r=new XDomainRequest,r.onload=function(){n(200,"success",[this.responseText])},r.ontimeout=function(){n(500,["The requested resource timed out."])},r.onerror=function(){n(404,"error",["The requested resource could not be found."])},r.onprogress=function(){},r.open(e.type,e.url),r.send(e.data||null)},abort:function(){r&&r.abort()}}}}),{VERSION:"0.9.0",settings:{},host:location.hostname,html_encode:function(e){return e=e?e:"",$("<div />").text(e).html()},html_decode:function(e){return e=e?e:"",$("<div />").html(e).text()},number_format:function(e,t){return e=e?e:"",t=t?t:",",e.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+t)||"0"},is_json:function(e,t){try{e=JSON.parse(e)}catch(n){return!1}return t?e:!0},pad:function(e,t,n,r){var n=n?n:"0",t=t?t:6,r=r?r:0;while(e.toString().length<t)switch(r.toString().toLowerCase()){case"1":case"right":e=e.toString()+n;break;default:e=n+e.toString()}return e},outer_html:function(e){return e?(e=e.length?e[0]:e,e.outerHTML?e.outerHTML:$("<div />").append($(e).clone()).html()):null},convert_versions:function(e,t){var n=[];return $([e,t]).each(function(e,t){var r=(t||"").replace(/\./g,"");while(r.length<3)r+="0";n.push(r)}),n},init:function(){var e=proboards.plugin.get("yootil_library"),t=e&&e.settings?e.settings:!1;return t&&(this.settings=t),this}}}().init(),yootil.queue=function(){function e(e){this.queue=[],this.poll=e||100,this.polling=!1,this.interval=!1}return e.prototype={add:function(e){return this.queue.push(e),this.start(),this},start:function(){this.queue.length&&!this.interval&&(this.interval=setInterval($.proxy(function(){this.polling||this.queue.length&&(this.polling=!0,this.queue[0]())},this),this.poll))},next:function(){return this.queue.length&&(this.queue.shift(),this.polling=!1),this.queue.length||clearInterval(this.interval),this},stop:function(){return this.queue=[],clearInterval(this.interval),this.polling=this.interval=!1,this}},e}(),yootil.key=function(){return{pb_key_obj:proboards.plugin.key,exists:function(e){return e&&this.pb_key_obj&&this.pb_key_obj(e)?!0:!1},get_key:function(e){return this.exists(e)?this.pb_key_obj(e):!1},has_value:function(e,t){if(this.exists(e)&&typeof this.pb_key_obj(e).get!="undefined"){var n=this.pb_key_obj(e).get(t||undefined);if(n&&n.toString().length)return!0}return!1},value:function(e,t,n){if(this.exists(e)&&this.has_value(e,t)){var r=this.pb_key_obj(e).get(t||undefined);return n&&(r=JSON.parse(r)),r}return""},clear:function(e,t){return this.set(e,"",t),this},set:function(e,t,n,r){if(this.exists(e)){r&&(t=JSON.stringify(t));if(typeof n=="undefined"||!n||!n.toString().length)n=t,t=undefined;this.pb_key_obj(e).set(n,t)}return this},write:function(e,t){return this.exists(e)?!!this.pb_key_obj(e).can_write(t):!1},read:function(e,t){return this.exists(e)?!!this.pb_key_obj(e).can_read(t):!1}}}(),yootil.create=function(){return{container:function(e,t,n,r,i,s,o,u){var a="",f=safe_content=typeof n!="undefined"||n?!0:!1;return e=e||"",t=t||"",typeof n=="object"&&(typeof n.title!="undefined"&&(f=n.title),typeof n.content!="undefined"&&(safe_content=n.content)),s=s?s:{},r=r?r:{},i=i?i:{},e=f?this.make_safe(e):e,e=typeof o!="undefined"&&!o?e:"<h2>"+e+"</h2>",t=safe_content?this.make_safe(t):t,a+='<div class="container">',a+=$('<div class="title-bar">'+e+"</div>").css(r).wrap("<span/>").parent().html(),a+=$('<div class="content pad-all">'+t+"</div>").css(i).wrap("<span/>").parent().html(),a+="</div>",typeof u=="undefined"||u?$(a).css(s):$(a).css(s).wrap("<span/>").parent().html()},page:function(e,t,n){var r=e.constructor==RegExp?e:new RegExp("/"+e,"i");return e&&location.href.match(r)&&(typeof t!="undefined"&&t.length&&(document.title+=" - "+t),(typeof n=="undefined"||n)&&$("#content[role=main]").children().hide()),yootil.create},nav_branch:function(e,t){var n=$("#nav-tree li:last").clone();return n&&n.length&&(n.find("a").attr("href",e).find("span").html(t),n.appendTo("#nav-tree")),n},profile_tab:function(e,t,n){if(yootil.location.check.profile()){var r=n?" class='ui-active'":"",i=$("div.show-user div.ui-tabMenu ul");i.length&&i.append($("<li"+r+"><a href='/user/"+yootil.page.member.id()+"/"+t+"'>"+e+"</a></li>"))}return yootil},profile_content_box:function(e){var t=e||$.unique_id("yootil-"),n=$("<div />").addClass("content-box center-col").attr("id",t);return n},bbc_button:function(e){return $(".controls").find(".bbcode-editor, .visual-editor").ready(function(){$(".controls").find(".bbcode-editor, .visual-editor").find(".group:last ul:last").append($("<li>").addClass("button").append($(e)))}),yootil}}}(),yootil.user=function(){return{data:{},has_data:function(){if(this.data&&typeof this.data.id!="undefined")return!0;if(typeof proboards!="undefined"){var e=proboards.data;if(typeof e!="undefined"&&typeof e=="function"){var t=proboards.data("user");if(typeof t!="undefined")return this.data=t,!0}}return!1},logged_in:function(){return this.has_data()&&typeof this.data.is_logged_in!="undefined"&&this.data.is_logged_in?!0:!1},id:function(){return this.has_data()&&typeof this.data.id!="undefined"?this.data.id:0},is_staff:function(){return this.has_data()&&typeof this.data.is_staff!="undefined"&&this.data.is_staff?!0:!1},name:function(){return this.has_data()&&typeof this.data.name!="undefined"?this.data.name:""},theme:function(){return this.has_data()&&typeof this.data.theme_id!="undefined"?this.data.theme_id:0},url:function(){return this.has_data()&&typeof this.data.url!="undefined"?this.data.url:""},avatar:function(){return this.has_data()&&typeof this.data.avatar!="undefined"?this.data.avatar:""},birthday:function(){return this.has_data()&&typeof this.data.birthday!="undefined"?this.data.birthday:{}},date_format:function(){return this.has_data()&&typeof this.data.date_format!="undefined"?this.data.date_format:""},friends:function(){return this.has_data()&&typeof this.data.friends!="undefined"?this.data.friends:{}},has_new_messages:function(){return this.has_data()&&typeof this.data.has_new_messages!="undefined"?this.data.has_new_messages:0},instant_messengers:function(){return this.has_data()&&typeof this.data.instant_messengers!="undefined"?this.data.instant_messengers:{}},last_online:function(){return this.has_data()&&typeof this.data.last_online!="undefined"?this.data.last_online:{}},posts:function(){return this.has_data()&&typeof this.data.posts!="undefined"?this.data.posts:0},rank:function(){return this.has_data()&&typeof this.data.rank!="undefined"?this.data.rank:{}},registered_on:function(){return this.has_data()&&typeof this.data.registered_on!="undefined"?this.data.registered_on:{}},status:function(){return this.has_data()&&typeof this.data.status!="undefined"?this.data.status:""},time_format:function(){return this.has_data()&&typeof this.data.time_format!="undefined"?this.data.time_format:""},username:function(){return this.has_data()&&typeof this.data.username!="undefined"?this.data.username:""},group_ids:function(){return this.has_data()&&typeof this.data.group_ids!="undefined"?this.data.group_ids:[]},groups:function(){return this.has_data()&&typeof this.data.groups!="undefined"?this.data.groups:{}}}}(),yootil.ajax=function(){return{bind:function(e,t,n,r,i){var s=$(t);return e="ajax"+e.substr(0,1).toUpperCase()+e.substr(1),s.length==1&&(i=i?i:t,e&&n&&t.length&&s[e](function(e,s,o){(r===!0||(new RegExp(r,"i")).test(o.url))&&$.proxy(n,i,e,s,o,t)()})),yootil},after_search:function(e,t){proboards.on("afterSearch",t?$.proxy(e,t):e)}}}(),yootil.sound=function(){return{audio_obj:null,play:function(e){$.browser.msie?(this.audio_obj||(this.audio_obj=$('<bgsound src="#" autostart="true" loop="1" width="1" height="1" id="yootil_sound_player">').appendTo($("body"))),this.audio_obj.attr("src",e)):(this.audio_obj&&this.audio_obj.remove(),this.audio_obj=$('<embed src="'+e+'" autostart="true" width="1" loop="1" height="1" id="yootil_sound_player">').appendTo($("body")))}}}(),yootil.storage=function(){var e={},t=!1;if(Modernizr.sessionstorage&&Modernizr.localstorage)t=!0;else{var n=window.name||"";if(n&&!n.length){var r;if(r=yootil.is_json(n,!0))e=r}}return{window_data:e,html5:t,set:function(e,t,n,r){return e&&t&&(t=n?JSON.stringify(t):t),r?yootil.storage.persistent.set(e,t):yootil.storage.session.set(e,t),this},get:function(e,t,n){var r="";return e&&(n?r=yootil.storage.persistent.get(e):r=yootil.storage.session.get(e),typeof n=="undefined"&&!r&&(r=yootil.storage.persistent.get(e)),t&&yootil.is_json(r)&&(r=JSON.parse(r))),r},remove:function(e,t){return e&&(t?yootil.storage.persistent.remove(e):yootil.storage.session.remove(e),typeof t=="undefined"&&yootil.storage.persistent.remove(e)),this}}}(),yootil.storage.persistent=function(){var e;return yootil.storage.html5||(e=$("<link />")[0],e&&e.addBehavior&&($(e).css("behavior","url(#default#userData)"),$("head").append($(e)),e.load("yootil"))),{set:function(t,n){return e?(e.setAttribute(t,n),e.save()):yootil.storage.html5&&localStorage.setItem(t,n),this},get:function(t){var n="";return e?n=e.getAttribute(t):yootil.storage.html5&&localStorage.length&&(n=localStorage.getItem(t)),n},remove:function(t){return e?e.removeAttribute(t):yootil.storage.html5&&localStorage.length&&localStorage.removeItem(t),this}}}(),yootil.storage.session=function(){function e(){yootil.storage.window_data&&(window.name=JSON.stringify(yootil.storage.window_data))}return{set:function(t,n){return yootil.storage.html5?sessionStorage.setItem(t,n):(yootil.storage.window_data[yootil.host]||(yootil.storage.window_data[yootil.host]={}),yootil.storage.window_data[yootil.host][t]=n,e()),this},get:function(e){var t="";return yootil.storage.html5&&sessionStorage.length?t=sessionStorage.getItem(e):yootil.storage.window_data&&yootil.storage.window_data[yootil.host]&&yootil.storage.window_data[yootil.host][e]&&(t=yootil.storage.window_data[yootil.host][e]),t},remove:function(t){return yootil.storage.html5&&sessionStorage.length?sessionStorage.removeItem(t):yootil.storage.window_data&&yootil.storage.window_data[yootil.host]&&(delete yootil.storage.window_data[yootil.host],e()),this}}}(),yootil.location=function(){return{}},yootil.location.check=function(){return{__is_page:function(e){return proboards.data&&proboards.data("route")&&proboards.data("route").name==e},board:function(){return this.__is_page("board")},bookmarks:function(){return this.__is_page("bookmarks")},calendar:function(){return this.__is_page("calendar")||this.__is_page("calendar_month")},calendar_day:function(){return this.__is_page("calendar_day")},forum:function(){return this.__is_page("home")||this.__is_page("forum")},members:function(){return this.__is_page("members")},message_list:function(){return this.__is_page("conversations")},message_thread:function(){return this.__is_page("conversation")},messaging:function(){return this.message_new()||this.conversation_new()||this.conversation_create()||this.message_quote()||this.conversation_new_user()},message_new:function(){return this.__is_page("new_message")},message_quote:function(){return this.__is_page("quote_messages")},conversation_new:function(){return this.__is_page("new_conversation")||this.__is_page("create_conversation")||this.__is_page("conversation_new_user")},conversation_create:function(){return this.__is_page("create_conversation")},conversation_new_user:function(){return this.__is_page("new_user_conversation")},posting:function(){return this.posting_quote()||this.posting_reply()||this.posting_thread()},posting_quote:function(){return this.__is_page("quote_posts")},posting_reply:function(){return this.__is_page("new_post")},posting_thread:function(){return this.__is_page("new_thread")},editing_post:function(){return this.__is_page("edit_post")},editing_thread:function(){return this.__is_page("edit_thread")},editing:function(){return this.editing_thread()||this.editing_post()},profile_activity:function(){return this.__is_page("show_user_activity")},profile_following:function(){return this.__is_page("show_user_following")},profile_friends:function(){return this.__is_page("show_user_friends")},profile_gift:function(){return this.__is_page("show_user_gift")},profile_groups:function(){return this.__is_page("show_user_groups")},profile_home:function(){return this.__is_page("user")},profile_edit_admin:function(){return this.__is_page("edit_user_admin")},profile_edit_avatar:function(){return this.__is_page("edit_user_avatar")},profile_edit_badges:function(){return this.__is_page("edit_user_badges")},profile_edit_notifications:function(){return this.__is_page("edit_user_notifications")},profile_edit_personal:function(){return this.__is_page("edit_user_personal")},profile_edit_privacy:function(){return this.__is_page("edit_user_privacy")},profile_edit_settings:function(){return this.__is_page("edit_user_settings")},profile_edit_social:function(){return this.__is_page("edit_user_social")},profile_notifications:function(){return this.__is_page("show_user_notifications")},profile:function(){return this.profile_activity()||this.profile_following()||this.profile_friends()||this.profile_gift()||this.profile_groups()||this.profile_home()||this.profile_notifications()},recent_posts:function(){return this.__is_page("all_recent_posts")||this.__is_page("recent_posts")},recent_threads:function(){return this.__is_page("recent_threads")},search:function(){return this.__is_page("search")},search_results:function(){return this.__is_page("search_results")},thread:function(){return this.__is_page("thread")}}}(),yootil.user.action=function(){var e="lastaction",t="";return $(function(){var n=function(t){return function(){yootil.storage.set(e,t)}};t=yootil.storage.get(e),yootil.storage.set(e,""),yootil.location.check.conversation_new()&&t=="created_conversation"&&(t=""),$(".form_thread_new").submit(n("created_thread")),$(".form_post_new").submit(n("replied")),$(".form_conversation_new").submit(n("created_conversation")),$(".form_message_new").submit(n("sent_message")),yootil.location.check.message_thread()?$(".form_post_quick_reply").submit(n("sent_message")):yootil.location.check.thread()&&$(".form_post_quick_reply").submit(n("replied"))}),{created_conversation:function(){return t=="created_conversation"},created_thread:function(){return t=="created_thread"},pmed:function(){return this.created_conversation()||this.sent_message()},posted:function(){return this.created_thread()||this.replied()},replied:function(){return t=="replied"},sent_message:function(){return t=="sent_message"}}}(),yootil.form=function(){return{post_form:function(){return yootil.location.check.posting_thread()?$("form.form_thread_new"):$("form.form_post_new")},edit_post_form:function(){return yootil.location.check.editing_post()?$("form.form_post_edit"):[]},edit_thread_form:function(){return yootil.location.check.editing_thread()?$("form.form_thread_edit"):[]},quick_reply_form:function(){return $("form.form_post_quick_reply")},post_quick_reply_form:function(){return yootil.location.check.thread()?this.quick_reply_form():[]},shoutbox_form:function(){return $("form.form_shoutbox_shoutbox")},conversation_form:function(){return yootil.location.check.message_new()?this.message_form():this.conversation_new_form()},conversation_new_form:function(){return $("form.form_conversation_new")},message_form:function(){return $("form.form_message_new")}}}(),yootil.page=function(){return{__get_data:function(e){return proboards&&proboards.dataHash&&proboards.dataHash.page&&typeof proboards.dataHash.page[e]!="undefined"?proboards.dataHash.page[e]:""}}}(),yootil.page.category=function(){return{__get_data:function(e){var t=yootil.page.__get_data("category");return t&&typeof t=="object"&&t[e]!="undefined"?t[e]:""},id:function(){return this.__get_data("id")},name:function(){return this.__get_data("name")}}}(),yootil.page.board=function(){return{__get_data:function(e){var t=yootil.page.__get_data("board");return t&&typeof t=="object"&&t[e]!="undefined"?t[e]:""},id:function(){return this.__get_data("id")},name:function(){return this.__get_data("name")},url:function(){return this.__get_data("url")}}}(),yootil.page.member=function(){return{__get_data:function(e){var t=yootil.page.__get_data("member");return t&&typeof t=="object"&&t[e]!="undefined"?t[e]:""},id:function(){return this.__get_data("id")},name:function(){return this.__get_data("name")},url:function(){return this.__get_data("url")}}}(),yootil.page.thread=function(){return{__get_data:function(e){var t=yootil.page.__get_data("thread");return t&&typeof t=="object"&&t[e]!="undefined"?t[e]:""},id:function(){return this.__get_data("created_by")},id:function(){return this.__get_data("created_on")},id:function(){return this.__get_data("id")},is_announcement:function(){return this.__get_data("is_announcement")==="1"},is_bookmarked:function(){return this.__get_data("is_bookmarked")==="1"},is_falling:function(){return this.__get_data("is_falling")==="1"},is_locked:function(){return this.__get_data("is_locked")==="1"},is_new:function(){return this.__get_data("is_new")==="1"},is_poll:function(){return this.__get_data("is_poll")==="1"},is_sticky:function(){return this.__get_data("is_sticky")==="1"},subject:function(){return this.__get_data("subject")},url:function(){return this.__get_data("url")}}}(),yootil.bar=function(){var e={_bar:null,_items:{},_total_items:0,has_bar:function(){if(!e.is_enabled())return!1;if(this._bar)return!0;var t=$("#yootil-bar-wrapper");return t.length==1?(this._bar=t,!0):!1},add:function(e,t,n,r,i,s){if(this.has_bar()&&e&&t){var n=n||"",o=$("<a href='"+e+"' style='margin-top: 3px; display: inline-block;'><img src='"+t+"' style='padding: 0px 3px;' alt='"+n+"' title='"+n+"' /></a>");r&&r.toString().length&&(this._items["_"+r.toString()]=o),i&&typeof i=="function"&&o.click(function(){return $.proxy(i,s)()}),this._total_items++,this._bar.find("#yootil-bar").append(o),this.show_bar()}},remove:function(e){e&&e.toString().length&&this._items["_"+e.toString()]&&(this._items["_"+e.toString()].remove(),delete this._items["_"+e.toString()],this._total_items--,this._bar.find("#yootil-bar a").length==0&&this._bar.css("display","none"))},total_items:function(){return this._total_items},get:function(e){if(e&&e.toString().length&&this._items["_"+e.toString()])return this._items["_"+e.toString()]},has:function(e){return e&&e.toString().length&&this._items["_"+e.toString()]?!0:!1},show_bar:function(){if(this._bar.find("#yootil-bar a").length>0){var e=yootil.storage.get("yootil_bar",!1);e&&(e.toString()=="1"||e.toString().length==0?this._bar.find("#yootil-bar").css("display","inline-block"):(this._bar.find("> img").attr("src","/images/button_collapse.png").attr("alt",">"),this._bar.find("#yootil-bar").css("display","none"))),this._bar.css("display","")}},is_enabled:function(){return yootil.settings&&yootil.settings.bar_enabled&&yootil.settings.bar_enabled==0?!1:!0}};return $(function(){if(!yootil.user.logged_in()||!e.is_enabled())return;var t=$("div#pbn-bar-wrapper");if(t.length==1){var n=t.clone();n.attr("id","yootil-bar-wrapper"),n.css({right:"inherit",left:"0px",display:"none"}),n.find("img:first").css("float","left").attr("src","/images/button_expand.png").attr("alt","<"),n.find("div#pbn-bar").css({width:"","float":"left","border-width":"1px 1px 0px 0px"}).attr("id","yootil-bar").html(""),n.find("> img").click(function(){var e=$("#yootil-bar");e.toggle(),e.is(":visible")?(e.css("display","inline-block"),$(this).attr("src","/images/button_expand.png").attr("alt","<")):$(this).attr("src","/images/button_collapse.png").attr("alt",">"),yootil.storage.set("yootil_bar",e.is(":visible")?"1":"0",!1,!0)}),$("body").append(n)}}),e}(),yootil.updater=function(){return{init:function(){return yootil.settings&&this.check_version(),this},check_version:function(){if(yootil.settings.check_for_update&&yootil.user.logged_in()&&yootil.user.is_staff()){var e=yootil.storage.get("yootil_last_check",!0),t=!1;if(!e||!e.t)t=!0,e={t:+(new Date),v:yootil.VERSION};var n=864e5,r=n*7,i=r*2,s=r*3,o=i*2,u=0;switch(parseInt(yootil.settings.how_often)){case 1:case 2:case 3:case 4:case 5:case 6:case 7:u=n*parseInt(yootil.settings.how_often);break;case 8:u=i;break;case 9:u=s;break;case 10:u=o}var a=+(new Date);if(e.t+u<a){var f=this;$.ajax({url:"http://pixeldepth.net/proboards/plugins/yootil/updates/update_check.php?t="+ +(new Date),context:this,crossDomain:!0,dataType:"json"}).done(function(t){e={t:+(new Date),v:t.v},yootil.storage.set("yootil_last_check",e,!0,!0)})}var l=yootil.convert_versions(yootil.VERSION,e.v);if(l[0]<l[1]){var c="<div class='yootil-notification-content'>";c+="<p>There is a new <strong>Yootil Library</strong> version available to install / download for this forum.  It is <strong>highly recommended</strong> to update to the latest version of this plugin.</p>",c+="<p style='margin-top: 8px;'>For more information, please visit the <a href='http://support.proboards.com/thread/429360/'>Yootil Library</a> forum topic on the <a href='http://support.proboards.com'>ProBoards forum</a>.</p>",c+="<p style='margin-top: 8px;'>This message can be disabled from the Yootil Library settings.</p>",c+="<p style='margin-top: 8px;'><a href='http://proboards.com/library/plugins/item/38'>ProBoards Plugin Library Link</a> | <a href='http://support.proboards.com/thread/429360/'>ProBoards Yootil Library Forum Link</a></p>",c+="</div>";var h=yootil.create.container("Staff Notification: Yootil Library Update Notice",c).show().addClass("yootil-notification");$(function(){$("div#content").prepend(h)})}t&&yootil.storage.set("yootil_last_check",e,!0,!0)}}}}().init();