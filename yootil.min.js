/**
* http://yootil.pixeldepth.net - 1.0.0
*/
yootil=function(){return{VERSION:"1.0.0",settings:{},images:{},host:location.hostname,notifications_queue:{},html_encode:function(e){return e=e?e:"",$("<div />").text(e).html()},html_decode:function(e){return e=e?e:"",$("<div />").html(e).text()},number_format:function(e,t){return e=e?e:"",t=t?t:",",e.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1"+t)||"0"},is_json:function(e,t){try{e=JSON.parse(e)}catch(n){return!1}return t?e:!0},pad:function(e,t,n,r){var n=n?n:"0",t=t?t:6,r=r?r:0;while(e.toString().length<t)switch(r.toString().toLowerCase()){case"1":case"right":e=e.toString()+n;break;default:e=n+e.toString()}return e},outer_html:function(e){return e?(e=e.length?e[0]:e,e.outerHTML?e.outerHTML:$("<div />").append($(e).clone()).html()):null},convert_versions:function(e,t){var n=[];return $([e,t]).each(function(e,t){var r=(t||"").replace(/\./g,"");while(r.length<3)r+="0";n.push(r)}),n},init:function(){var e=proboards.plugin.get("yootil_library"),t=e&&e.settings?e.settings:!1;return t&&(this.settings=t),e.images&&(this.images=e.images),this},version:function(){return this.VERSION},ts:function(){return this.timestamp()},timestamp:function(){return+(new Date)}}}().init(),yootil.queue=function(){function e(e){this.queue=[],this.poll=e||100,this.polling=!1,this.interval=!1}return e.prototype={add:function(e){return this.queue.push(e),this.start(),this},start:function(){this.queue.length&&!this.interval&&(this.interval=setInterval($.proxy(function(){this.polling||this.queue.length&&(this.polling=!0,this.queue[0]())},this),this.poll))},next:function(){return this.queue.length&&(this.queue.shift(),this.polling=!1),this.queue.length||clearInterval(this.interval),this},pause:function(){return clearInterval(this.interval),this.polling=this.interval=!1,this},stop:function(){return this.queue=[],clearInterval(this.interval),this.polling=this.interval=!1,this}},e}(),yootil.key=function(){return{pb_key_obj:pb.plugin.key,exists:function(e){return e&&this.pb_key_obj&&this.pb_key_obj(e)?!0:!1},get_key:function(e){return this.exists(e)?this.pb_key_obj(e):!1},has_value:function(e,t){if(this.exists(e)&&typeof this.pb_key_obj(e).get!="undefined"){var n=this.pb_key_obj(e).get(t||undefined);if(n&&n.toString().length)return!0}return!1},value:function(e,t,n){if(this.exists(e)&&this.has_value(e,t)){var r=this.pb_key_obj(e).get(t||undefined);return n&&yootil.is_json(r)&&(r=JSON.parse(r)),r}return""},clear:function(e,t){return this.set(e,"",t)},set:function(e,t,n,r,i){if(this.exists(e)){var s={object_id:n,value:t};r&&typeof r=="object"&&(r.success&&(s.success=r.context?$.proxy(r.success,r.context):r.success),r.error&&(s.error=r.context?$.proxy(r.error,r.context):r.error),r.complete&&(s.complete=r.context?$.proxy(r.complete,r.context):r.complete));if(!i)return this.pb_key_obj(e).set(s);switch(i){case"push":case"unshift":s.value.constructor==Array&&s.value.length>1&&(s.values=s.value,delete s.value);break;case"pop":case"shift":s.value&&(s.num_items=~~s.value,delete s.value)}if(typeof this.pb_key_obj(e)[i]!="undefined")return this.pb_key_obj(e)[i](s)}},set_on:function(e,t,n,r){if(!r)return;return this.pb_key_obj(e).set_on(r,n,t)},new_thread:function(e,t,n){return this.set_on(e,t,n,"thread_new")},new_post:function(e,t,n){return this.set_on(e,t,n,"post_new")},post_quick_reply:function(e,t,n){return this.set_on(e,t,n,"post_quick_reply")},append:function(e,t,n,r){return this.set(e,t,n,r,"append")},prepend:function(e,t,n,r){return this.set(e,t,n,r,"prepend")},increment:function(e,t,n,r){return this.set(e,t,n,r,"increment")},decrement:function(e,t,n,r){return this.set(e,t,n,r,"decrement")},pop:function(e,t,n,r){var i=this.set(e,t,n,r,"pop");return i&&!i.constructor==Array&&(i=[i]),i},push:function(e,t,n,r){return this.set(e,t,n,r,"push")},push_unique:function(e,t,n,r,i){var s=this.value(e);if(s&&s.constructor==Array&&t){var o=[],u=r?$.inArray:$.inArrayLoose;if(t.constructor==Array)for(var a=0,f=t.length;a<f;a++)u(t[a],s)==-1&&o.push(t[a]);else u(t,s)==-1&&(o=t);if(o&&o.length)return this.push(e,o,n,i)}},shift:function(e,t,n,r){var i=this.set(e,t,n,r,"shift");return i&&!i.constructor==Array&&(i=[i]),i},unshift:function(e,t,n,r){return this.set(e,t,n,r,"unshift")},unshift_unique:function(e,t,n,r,i){var s=this.value(e);if(s&&s.constructor==Array&&t){var o=[],u=r?$.inArray:$.inArrayLoose;if(t.constructor==Array)for(var a=0,f=t.length;a<f;a++)u(t[a],s)==-1&&o.push(t[a]);else u(t,s)==-1&&(o=t);if(o&&o.length)return this.unshift(e,o,n,i)}},write:function(e,t){return this.exists(e)?typeof this.pb_key_obj(e).can_write!="undefined"?!!this.pb_key_obj(e).can_write(t):!0:!1},read:function(e,t){return this.exists(e)?typeof this.pb_key_obj(e).can_read!="undefined"?!!this.pb_key_obj(e).can_read(t):!0:!1},type:function(e,t){var n=this.pb_key_obj(e).type();if(t){var r=pb.plugin.key_types();for(var i in r)if(r[i]==n){n=i;break}}return n},value_length:function(e){return typeof this.value(e)=="string"?this.value(e).length:JSON.stringify(this.value(e)).length},user:function(e){return this.type(e)==1?!0:!1},super_user:function(e){return this.type(e)==2?!0:!1},thread:function(e){return this.type(e)==3?!0:!1},post:function(e){return this.type(e)==4?!0:!1},conversation:function(e){return this.type(e)==5?!0:!1},message:function(e){return this.type(e)==6?!0:!1},super_forum:function(e){return this.type(e)==7?!0:!1},has_space:function(e){var t=this.super_forum(e)?pb.data("plugin_max_super_forum_key_length"):pb.data("plugin_max_key_length");return this.value_length(e)<t?!0:!1},space_left:function(e){var t=this.super_forum(e)?pb.data("plugin_max_super_forum_key_length"):pb.data("plugin_max_key_length"),n=this.value_length(e),r=t-n;return r<0?0:r}}}(),yootil.forum=function(){return{__get_data:function(e){return proboards&&proboards.dataHash&&typeof proboards.dataHash[e]!="undefined"?proboards.dataHash[e]:""},ad_free:function(){return this.__get_data("ad_free")},is_ad_free:function(){return this.ad_free()==1?!0:!1},default_avatar:function(){return this.__get_data("default_avatar")},id:function(){return this.__get_data("forum_id")},login_url:function(){return this.__get_data("login_url")},current_user_guest:function(){return this.__get_data("is_current_user_guest")},is_current_user_guest:function(){return this.current_user_guest()==1?!0:!1},mark_boards_read_url:function(){return this.__get_data("mark_boards_read_url")},plugin_max_key_length:function(){return this.__get_data("plugin_max_key_length")},plugin_max_super_forum_key_length:function(){return this.__get_data("plugin_max_super_forum_key_length")},register_url:function(){return this.__get_data("register_url")}}}(),yootil.create=function(){return{container:function(e,t,n,r,i,s,o,u){var a="",f=safe_content=typeof n!="undefined"||n?!0:!1;return e=e||"",t=t||"",typeof n=="object"&&(typeof n.title!="undefined"&&(f=n.title),typeof n.content!="undefined"&&(safe_content=n.content)),s=s?s:{},r=r?r:{},i=i?i:{},e=f?yootil.html_encode(e):e,e=typeof o!="undefined"&&!o?e:"<h2>"+e+"</h2>",t=safe_content?yootil.html_encode(t):t,a+='<div class="container">',a+=$('<div class="title-bar">'+e+"</div>").css(r).wrap("<span/>").parent().html(),a+=$('<div class="content pad-all">'+t+"</div>").css(i).wrap("<span/>").parent().html(),a+="</div>",typeof u=="undefined"||u?$(a).css(s):$(a).css(s).wrap("<span/>").parent().html()},page:function(e,t,n){var r=e.constructor==RegExp?e:new RegExp("/"+e,"i");return e&&location.href.match(r)&&(typeof t!="undefined"&&t.length&&(document.title+=" - "+t),(typeof n=="undefined"||n)&&$("#content[role=main]").children().hide()),yootil.create},nav_branch:function(e,t){var n=$("#nav-tree li:last").clone();return n&&n.length&&(n.find("a").attr("href",e).find("span").html(t),n.appendTo("#nav-tree")),n},profile_tab:function(e,t,n){if(yootil.location.profile()){var r=n?" class='ui-active'":"",i=$("div.show-user div.ui-tabMenu ul");i.length&&i.append($("<li"+r+"><a href='/user/"+yootil.page.member.id()+"/"+t+"'>"+e+"</a></li>"))}return this},profile_content_box:function(e){var t=e||$.unique_id("yootil-"),n=$("<div />").addClass("content-box center-col").attr("id",t);return n},bbc_button:function(e,t){return $(".controls").find(".bbcode-editor, .visual-editor").ready(function(){var n=$("<li>").addClass("button").append($(e));t&&n.click(t),$(".controls").find(".bbcode-editor, .visual-editor").find(".group:last ul:last").append(n)}),this},ubbc_tab:function(e,t,n,r,i){n=n||yootil.ts(),e=e||n,t=t||"";var s=$("<li id='menu-item-"+n+"'><a href='#'>"+e+"</a></li>"),o=$("ul.wysiwyg-tabs").append(s),u=$("<div id='"+n+"'>"+t+"</div>");return typeof r=="undefined"?u.css({border:"1px solid #E6E6E6",padding:"5px"}):r&&typeof r=="object"&&u.css(r),u.hide().insertBefore($("ul.wysiwyg-tabs")),o.find("li").click(function(e){var t=$(this);e.preventDefault(),t.parent().find("li").removeClass("ui-active"),t.addClass("ui-active"),t.parent().find("li").each(function(){var e=$(this).attr("id");if(e.match(/bbcode|visual/i))$(".ui-wysiwyg .editors").hide();else{if(t.attr("id")==e)return;var n="";e&&(n="#"+e.split("menu-item-")[1]),$(n).length&&(i&&i.hide&&(i.context?$.proxy(i.hide,i.context,s,u)():i.hide(s,u)),$(n).hide())}});var n=t.attr("id"),r="";n&&(r="#"+n.split("menu-item-")[1]),n.match(/bbcode|visual/i)?$(".ui-wysiwyg .editors").show():$(r).length&&(i&&i.show&&(i.context?$.proxy(i.show,i.context,s,u)():i.show(s,u)),$(r).show())}),u}}}(),yootil.user=function(){return{data:{},has_data:function(){if(this.data&&typeof this.data.id!="undefined")return!0;if(typeof proboards!="undefined"){var e=proboards.data;if(typeof e!="undefined"&&typeof e=="function"){var t=proboards.data("user");if(typeof t!="undefined")return this.data=t||{},!0}}return!1},logged_in:function(){return this.has_data()&&typeof this.data.is_logged_in!="undefined"&&this.data.is_logged_in?!0:!1},id:function(){return this.has_data()&&typeof this.data.id!="undefined"?this.data.id:0},is_staff:function(){return this.has_data()&&typeof this.data.is_staff!="undefined"&&this.data.is_staff?!0:!1},name:function(){return this.has_data()&&typeof this.data.name!="undefined"?this.data.name:""},theme:function(){return this.has_data()&&typeof this.data.theme_id!="undefined"?this.data.theme_id:0},url:function(){return this.has_data()&&typeof this.data.url!="undefined"?this.data.url:""},avatar:function(){return this.has_data()&&typeof this.data.avatar!="undefined"?this.data.avatar:""},birthday:function(){return this.has_data()&&typeof this.data.birthday!="undefined"?this.data.birthday:{}},date_format:function(){return this.has_data()&&typeof this.data.date_format!="undefined"?this.data.date_format:""},friends:function(){return this.has_data()&&typeof this.data.friends!="undefined"?this.data.friends:{}},has_new_messages:function(){return this.has_data()&&typeof this.data.has_new_messages!="undefined"?this.data.has_new_messages:0},instant_messengers:function(){return this.has_data()&&typeof this.data.instant_messengers!="undefined"?this.data.instant_messengers:{}},last_online:function(){return this.has_data()&&typeof this.data.last_online!="undefined"?this.data.last_online:{}},posts:function(){return this.has_data()&&typeof this.data.posts!="undefined"?this.data.posts:0},rank:function(){return this.has_data()&&typeof this.data.rank!="undefined"?this.data.rank:{}},registered_on:function(){return this.has_data()&&typeof this.data.registered_on!="undefined"?this.data.registered_on:{}},status:function(){return this.has_data()&&typeof this.data.status!="undefined"?this.data.status:""},time_format:function(){return this.has_data()&&typeof this.data.time_format!="undefined"?this.data.time_format:""},username:function(){return this.has_data()&&typeof this.data.username!="undefined"?this.data.username:""},group_ids:function(){return this.has_data()&&typeof this.data.group_ids!="undefined"?this.data.group_ids:[]},groups:function(){return this.has_data()&&typeof this.data.groups!="undefined"?this.data.groups:{}},is_invisible:function(){return this.has_data()&&typeof this.data.is_invisible!="undefined"&&this.data.is_invisible?!0:!1},proboards_plus:function(){return this.has_data()&&typeof this.data.proboards_plus!="undefined"&&this.data.proboards_plus?!0:!1},block_list:function(){return this.has_data()&&typeof this.data.block_list!="undefined"&&this.data.block_list?this.data.block_list:{}}}}(),yootil.ajax=function(){return{bind:function(e,t,n,r,i){var s=$(t);return e="ajax"+e.substr(0,1).toUpperCase()+e.substr(1),s.length==1&&(i=i?i:t,e&&n&&t.length&&s[e](function(e,s,o){(r===!0||(new RegExp(r,"i")).test(o.url))&&$.proxy(n,i,e,s,o,t)()})),this},after_search:function(e,t){return proboards.on("afterSearch",t?$.proxy(e,t):e),this}}}(),yootil.storage=function(){var e={},t=!1;if(Modernizr.sessionstorage&&Modernizr.localstorage)t=!0;else{var n=window.name||"";if(n&&!n.length){var r;if(r=yootil.is_json(n,!0))e=r}}return{window_data:e,html5:t,set:function(e,t,n,r){return e&&t&&(t=n?JSON.stringify(t):t),r?yootil.storage.persistent.set(e,t):yootil.storage.session.set(e,t),this},get:function(e,t,n){var r="";return e&&(n?r=yootil.storage.persistent.get(e):r=yootil.storage.session.get(e),typeof n=="undefined"&&!r&&(r=yootil.storage.persistent.get(e)),t&&yootil.is_json(r)&&(r=JSON.parse(r))),r},remove:function(e,t){return e&&(t?yootil.storage.persistent.remove(e):yootil.storage.session.remove(e),typeof t=="undefined"&&yootil.storage.persistent.remove(e)),this}}}(),yootil.storage.persistent=function(){var e;return yootil.storage.html5||(e=$("<link />")[0],e&&e.addBehavior&&($(e).css("behavior","url(#default#userData)"),$("head").append($(e)),e.load("yootil"))),{set:function(t,n){return e?(e.setAttribute(t,n),e.save()):yootil.storage.html5&&localStorage.setItem(t,n),this},get:function(t){var n="";return e?n=e.getAttribute(t):yootil.storage.html5&&localStorage.length&&(n=localStorage.getItem(t)),n},remove:function(t){return e?e.removeAttribute(t):yootil.storage.html5&&localStorage.length&&localStorage.removeItem(t),this}}}(),yootil.storage.session=function(){function e(){yootil.storage.window_data&&(window.name=JSON.stringify(yootil.storage.window_data))}return{set:function(t,n){return yootil.storage.html5?sessionStorage.setItem(t,n):(yootil.storage.window_data[yootil.host]||(yootil.storage.window_data[yootil.host]={}),yootil.storage.window_data[yootil.host][t]=n,e()),this},get:function(e){var t="";return yootil.storage.html5&&sessionStorage.length?t=sessionStorage.getItem(e):yootil.storage.window_data&&yootil.storage.window_data[yootil.host]&&yootil.storage.window_data[yootil.host][e]&&(t=yootil.storage.window_data[yootil.host][e]),t},remove:function(t){return yootil.storage.html5&&sessionStorage.length?sessionStorage.removeItem(t):yootil.storage.window_data&&yootil.storage.window_data[yootil.host]&&(delete yootil.storage.window_data[yootil.host],e()),this}}}(),yootil.location=function(){return{cached_route:proboards.data&&proboards.data("route")?proboards.data("route").name:"",__is_page:function(e){return this.cached_route==e},board:function(){return this.__is_page("board")||this.__is_page("list_threads")},bookmarks:function(){return this.__is_page("bookmarks")},calendar:function(){return this.__is_page("calendar")||this.__is_page("calendar_month")||this.__is_page("calendar_list")},calendar_day:function(){return this.__is_page("calendar_day")},forum:function(){return this.home()},home:function(){return this.__is_page("home")||this.__is_page("forum")},members:function(){return this.__is_page("members")||this.__is_page("list_members")},message_list:function(){return this.__is_page("conversations")||this.__is_page("conversations_inbox")||this.__is_page("list_conversations")},message_thread:function(){return this.__is_page("conversation")||this.__is_page("list_messages")},messaging:function(){return this.message_new()||this.conversation_new()||this.message_quote()},message_new:function(){return this.__is_page("new_message")},message_quote:function(){return this.__is_page("quote_messages")},conversation_new:function(){return this.__is_page("new_conversation")||this.__is_page("create_conversation")||this.__is_page("conversation_new_user")},conversation_create:function(){return this.__is_page("create_conversation")},conversation_new_user:function(){return this.__is_page("new_user_conversation")},posting:function(){return this.posting_quote()||this.posting_reply()||this.posting_thread()},posting_quote:function(){return this.__is_page("quote_posts")},posting_reply:function(){return this.__is_page("new_post")},posting_thread:function(){return this.__is_page("new_thread")},editing_post:function(){return this.__is_page("edit_post")},editing_thread:function(){return this.__is_page("edit_thread")},editing:function(){return this.editing_thread()||this.editing_post()},page:function(){return this.__is_page("page")},profile_activity:function(){return this.__is_page("show_user_activity")},profile_following:function(){return this.__is_page("show_user_following")},profile_friends:function(){return this.__is_page("show_user_friends")},profile_gift:function(){return this.__is_page("show_user_gift")},profile_groups:function(){return this.__is_page("show_user_groups")},profile_home:function(){return this.__is_page("user")},profile_edit_admin:function(){return this.__is_page("edit_user_admin")},profile_edit_avatar:function(){return this.__is_page("edit_user_avatar")},profile_edit_badges:function(){return this.__is_page("edit_user_badges")},profile_edit_notifications:function(){return this.__is_page("edit_user_notifications")},profile_edit_personal:function(){return this.__is_page("edit_user_personal")},profile_edit_privacy:function(){return this.__is_page("edit_user_privacy")},profile_edit_settings:function(){return this.__is_page("edit_user_settings")},profile_edit_social:function(){return this.__is_page("edit_user_social")},profile_notifications:function(){return this.__is_page("show_user_notifications")||this.__is_page("show_more_notifications")},profile:function(){return this.profile_activity()||this.profile_following()||this.profile_friends()||this.profile_gift()||this.profile_groups()||this.profile_home()||this.profile_notifications()},recent_posts:function(){return this.__is_page("all_recent_posts")||this.__is_page("recent_posts")},recent_threads:function(){return this.__is_page("recent_threads")||this.__is_page("recent_threads_created")},search:function(){return this.__is_page("search")},search_results:function(){return this.__is_page("search_results")},thread:function(){return this.__is_page("thread")||this.__is_page("list_posts")}}}(),yootil.location.check=yootil.location,yootil.form=function(){return{post:function(){return yootil.location.posting_thread()?$("form.form_thread_new"):$("form.form_post_new")},edit_post:function(){return yootil.location.editing_post()?$("form.form_post_edit"):[]},edit_thread:function(){return yootil.location.editing_thread()?$("form.form_thread_edit"):[]},quick_reply:function(){return $("form.form_post_quick_reply")},post_quick_reply:function(){return yootil.location.thread()?this.quick_reply():[]},message_quick_reply:function(){return yootil.location.message_thread()?this.quick_reply():[]},shoutbox:function(){return $("form.form_shoutbox_shoutbox")},conversation:function(){return yootil.location.message_new()?this.message():this.conversation_new()},conversation_new:function(){return $("form.form_conversation_new")},message:function(){return $("form.form_message_new")},edit_personal:function(){return $("form.form_user_edit_personal")},edit_social:function(){return $("form.form_user_edit_social")},edit_settings:function(){return $("form.form_user_edit_settings")},edit_privacy:function(){return $("form.form_user_edit_privacy")},edit_staff_options:function(){return $("form.form_user_edit_admin")},any_messaging:function(){var e=[];return this.conversation().length?e=this.conversation():this.conversation_new().length?e=this.conversation_new():this.message().length?e=this.message():this.message_quick_reply().length&&(e=this.message_quick_reply()),e},any_posting:function(){var e=[];return this.post().length?e=this.post():this.edit_post().length?e=this.edit_post():this.post_quick_reply().length?e=this.post_quick_reply():this.edit_thread().length&&(e=this.edit_thread()),e},post_form:function(){return this.post()},edit_post_form:function(){return this.edit_post()},edit_thread_form:function(){return this.edit_thread()},quick_reply_form:function(){return this.quick_reply()},post_quick_reply_form:function(){return this.post_quick_reply()},shoutbox_form:function(){return this.shoutbox()},conversation_form:function(){return this.conversation()},conversation_new_form:function(){return this.conversation_new()},message_form:function(){return this.message()}}}(),yootil.page=function(){return{__get_data:function(e){return proboards&&proboards.dataHash&&proboards.dataHash.page&&typeof proboards.dataHash.page[e]!="undefined"?proboards.dataHash.page[e]:""}}}(),yootil.page.category=function(){return{__get_data:function(e){var t=yootil.page.__get_data("category");return t&&typeof t=="object"&&t[e]!="undefined"?t[e]:""},id:function(){return this.__get_data("id")},name:function(){return this.__get_data("name")}}}(),yootil.page.board=function(){return{__get_data:function(e){var t=yootil.page.__get_data("board");return t&&typeof t=="object"&&t[e]!="undefined"?t[e]:""},id:function(){return this.__get_data("id")},name:function(){return this.__get_data("name")},url:function(){return this.__get_data("url")},description:function(){return this.__get_data("description")},disable_post_counts:function(){return this.__get_data("disable_post_counts")==1},disable_posting:function(){return this.__get_data("disable_posting")==1},display_name:function(){return this.__get_data("display_name")},hidden:function(){return this.__get_data("hidden")==1},posts:function(){return this.__get_data("posts")},show_announcements:function(){return this.__get_data("show_announcements")==1},threads:function(){return this.__get_data("threads")}}}(),yootil.page.member=function(){return{__get_data:function(e){var t=yootil.page.__get_data("member");return t&&typeof t=="object"&&t[e]!="undefined"?t[e]:""},id:function(){return this.__get_data("id")},name:function(){return this.__get_data("name")},url:function(){return this.__get_data("url")},display_group_id:function(){return this.__get_data("display_group_id")}}}(),yootil.page.thread=function(){return{__get_data:function(e){var t=yootil.page.__get_data("thread");return t&&typeof t=="object"&&t[e]!="undefined"?t[e]:""},id:function(){return this.__get_data("id")},created_on:function(){return this.__get_data("created_on")},is_announcement:function(){return this.__get_data("is_announcement")==1},is_bookmarked:function(){return this.__get_data("is_bookmarked")==1},is_falling:function(){return this.__get_data("is_falling")==1},is_locked:function(){return this.__get_data("is_locked")==1},is_new:function(){return this.__get_data("is_new")==1},is_poll:function(){return this.__get_data("is_poll")==1},is_sticky:function(){return this.__get_data("is_sticky")==1},subject:function(){return this.__get_data("subject")},url:function(){return this.__get_data("url")},board_id:function(){return this.__get_data("board_id")},created_by:function(){return this.__get_data("created_by")},last_post_id:function(){return this.__get_data("last_post_id")},first_post_id:function(){return this.__get_data("first_post_id")},last_post_time:function(){return this.__get_data("last_post_time")}}}(),yootil.page.post=function(){return{__get_data:function(e){var t=yootil.page.__get_data("post");return t&&typeof t=="object"&&t[e]!="undefined"?t[e]:""},created_by:function(){return this.__get_data("created_by")},created_on:function(){return this.__get_data("created_on")},id:function(){return this.__get_data("id")},liked:function(){return this.__get_data("liked")==1},thread_id:function(){return this.__get_data("thread_id")},url:function(){return this.__get_data("url")}}}(),yootil.element={},yootil.element.get=yootil.get=function(){return{mini_profiles:function(e){var t=~~e?":has(a.user-link.user-"+~~e+")":"";return $(".mini-profile"+t)},mini_profile_avatars:function(e){var t=~~e?":has(a.user-link.user-"+~~e+")":"";return $(".mini-profile .avatar"+t)},mini_profile_user_links:function(e){var t=~~e?".user-"+~~e:"";return $(".mini-profile a.user-link"+t)},posts:function(e){var t=~~e?"-"+~~e:"";return $("tr[id^=post"+t+"]")},user_posts:function(e){return e?$("tr[id^=post]:has(.mini-profile a.user-link.user-"+~~e+")"):[]},quick_reply:function(){return $(".quick-reply")},mini_profile_info:function(e){var t=~~e?":has(a.user-link.user-"+~~e+")":"";return $(".mini-profile"+t+" .info")},signatures:function(e){var t=~~e?":has(.mini-profile a.user-link.user-"+~~e+")":"";return $("tr[id^=post-]"+t+" .foot .signature, tr[id^=message-]"+t+" .foot .signature")},last_edit:function(e){var t=~~e?":has(.mini-profile a.user-link.user-"+~~e+")":"";return $("tr[id^=post-]"+t+" .foot .edited_by, tr[id^=message-]"+t+" .foot .edited_by")},post_info:function(e){var t=~~e?":has(.mini-profile a.user-link.user-"+~~e+")":"";return $("tr[id^=post-]"+t+" .content .info, tr[id^=message-]"+t+" .content .info")},post_controls:function(e){var t=~~e?":has(.mini-profile a.user-link.user-"+~~e+")":"";return $("tr[id^=post-]"+t+" .content .controls, tr[id^=message-]"+t+" .content .controls")},summary:function(){return $(".messages.summary, .posts.summary")},nav_tree:function(){return $("#navigation-tree")},nav_branches:function(){return $("#navigation-tree #nav-tree .nav-tree-branch")},last_nav_branch:function(){return $("#navigation-tree #nav-tree .nav-tree-branch:last")},nav_branch:function(e,t){if(!e)return[];t=t||"text";var n=[];return $("#navigation-tree #nav-tree .nav-tree-branch a").each(function(){var r=t=="url"?$(this).attr("href"):$(this).text();e.constructor==RegExp?e.test(r)&&n.push($(this).parent().parent()):typeof e=="string"&&r.indexOf(e)!=-1&&n.push($(this).parent().parent())}),n}}}(),yootil.element.remove=yootil.remove=function(){return{mini_profiles:function(e,t){var n=yootil.element.get.mini_profiles(e);return n.length&&n[t?"hide":"remove"](),n},mini_profile_avatars:function(e,t){var n=yootil.element.get.mini_profile_avatars(e);return n.length&&n[t?"hide":"remove"](),n},mini_profile_user_links:function(e,t,n){var r=yootil.element.get.mini_profile_user_links(e),i=n?r.parent().find("br:first"):null;return r.length&&(r[t?"hide":"remove"](),i&&i[t?"hide":"remove"]()),r},posts:function(e,t){var n=yootil.element.get.posts(e);return n.length&&n[t?"hide":"remove"](),n},user_posts:function(e,t){var n=yootil.element.get.user_posts(e);return n.length&&n[t?"hide":"remove"](),n},quick_reply:function(e){var t=yootil.element.get.quick_reply();return t.length&&t[e?"hide":"remove"](),t},mini_profile_info:function(e,t){var n=yootil.element.get.mini_profile_info(e);return n.length&&n[t?"hide":"remove"](),n},signatures:function(e,t){var n=yootil.element.get.signatures(e);return n.length&&n[t?"hide":"remove"](),n},last_edit:function(e,t){var n=yootil.element.get.last_edit(e);return n.length&&n[t?"hide":"remove"](),n},post_info:function(e,t){var n=yootil.element.get.post_info(e);return n.length&&n[t?"hide":"remove"](),n},post_controls:function(e,t){var n=yootil.element.get.post_controls(e);return n.length&&n[t?"hide":"remove"](),n},summary:function(e){var t=yootil.element.get.summary();return t.length&&t[e?"hide":"remove"](),t},nav_tree:function(e){var t=yootil.element.get.nav_tree();return t.length&&t[e?"hide":"remove"](),t},nav_branches:function(e){var t=yootil.element.get.nav_branches();return t.length&&t[e?"hide":"remove"](),t},last_nav_branch:function(e){var t=yootil.element.get.last_nav_branch();return t.length&&t[e?"hide":"remove"](),t},nav_branch:function(e,t,n){var r=yootil.element.get.nav_branch(e,t);if(r.length)for(var i in r)r[i][n?"hide":"remove"]();return r}}}(),yootil.bar=function(){var e={_bar:null,_items:{},_total_items:0,has_bar:function(){if(!e.is_enabled())return!1;if(this._bar)return!0;var t=$("#yootil-bar-wrapper");return t.length==1?(this._bar=t,!0):!1},add:function(e,t,n,r,i,s){var o=this,n=n||"";return $(function(){if(o.has_bar()&&e&&t){var u=$("<a href='"+e+"' style='margin-top: 3px; display: inline-block;'><img src='"+t+"' style='padding: 0px 3px;' alt='"+n+"' title='"+n+"' /></a>");r&&r.toString().length&&(o._items["_"+r.toString()]=u),i&&typeof i=="function"&&u.click(function(){return $.proxy(i,s)()}),o._total_items++,o._bar.find("#yootil-bar").append(u),o.show_bar()}}),this},remove:function(e){return e&&e.toString().length&&this._items["_"+e.toString()]&&(this._items["_"+e.toString()].remove(),delete this._items["_"+e.toString()],this._total_items--,this._bar.find("#yootil-bar a").length==0&&this._bar.css("display","none")),this},total_items:function(){return this._total_items},get:function(e){if(e&&e.toString().length&&this._items["_"+e.toString()])return this._items["_"+e.toString()]},has:function(e){return e&&e.toString().length&&this._items["_"+e.toString()]?!0:!1},show_bar:function(){if(this._bar.find("#yootil-bar a").length>0){var e=yootil.storage.get("yootil_bar",!1);e&&(e.toString()=="1"||e.toString().length==0?this._bar.find("#yootil-bar").css("display","inline-block"):(this._bar.find("> img").attr("src",yootil.images.collapse).attr("alt",">"),this._bar.find("#yootil-bar").css("display","none"))),this._bar.css("display","")}},is_enabled:function(){return yootil.settings&&yootil.settings.bar_enabled&&yootil.settings.bar_enabled==0?!1:!0}};return $(function(){if(!yootil.user.logged_in()||!e.is_enabled())return;var t=!1,n=$("div#pbn-bar-wrapper");n.length||(t=!0,n=$('<div style="position: fixed; right: inherit; bottom: 0px; left: 0px; height: 22px; *height: 23px; display: none; text-align: right; z-index: 20;" id="yootil-bar-wrapper"><img style="display: inline-block; float: left;" alt="<" src="'+yootil.images.expand+'"><div style="display: inline-block; float: left; height: 23px; background-color: #F0F0F0; border-width: 1px 1px 0px 0px; border-style: solid; border-color: #B0B0B0;" id="yootil-bar"></div></div>'));if(n.length==1){if(t)r=n;else{var r=n.clone();r.attr("id","yootil-bar-wrapper"),r.css({right:"inherit",left:"0px",display:"none"}),r.find("img:first").css("float","left").attr("src",yootil.images.expand).attr("alt","<"),r.find("div#pbn-bar").css({width:"","float":"left","border-width":"1px 1px 0px 0px"}).attr("id","yootil-bar").html("")}r.find("> img").click(function(){var e=$("#yootil-bar");e.toggle(),e.is(":visible")?(e.css("display","inline-block"),$(this).attr("src",yootil.images.expand).attr("alt","<")):$(this).attr("src",yootil.images.collapse).attr("alt",">"),yootil.storage.set("yootil_bar",e.is(":visible")?"1":"0",!1,!0)}),$("body").append(r)}}),e}(),yootil.notifications=function(){function e(e,t,n){return yootil.notifications_queue[e]||(yootil.notifications_queue[e]=new yootil.queue),this.html_tpl="",this.key=e||null,this.plugin=yootil.key.exists(this.key),this.data={},this.plugin&&(this.data=yootil.key.value(this.key,yootil.user.id(),!0)||{}),this.parse_template(t||null,n||null),this}return e.prototype={parse_template:function(e,t){var n=t?" yootil-notifications-"+t:"";this.html_tpl=e&&e.length?e:"",this.html_tpl.length||(this.html_tpl+='<div class="yootil-notifications '+this.key+n+'">',this.html_tpl+='<div class="yootil-notifications-image">',this.html_tpl+="{NOTIFICATION_IMAGE}",this.html_tpl+="</div>",this.html_tpl+='<div class="yootil-notifications-message">',this.html_tpl+="{NOTIFICATION_MESSAGE}",this.html_tpl+="</div>",this.html_tpl+="</div>"),this.html_tpl=this.html_tpl.replace("{PLUGIN_KEY}",this.key+n),this.html_tpl=this.html_tpl.replace("{NOTIFICATION_IMAGE}",'<img src="'+yootil.images.notify+'" />')},create:function(e,t,n){if(this.plugin){var r=t||yootil.user.id(),i=+(new Date);n?this.data[i]={i:n,m:e}:(n=i,this.data[i]=e),this.check_key_data(n),yootil.key.set(this.key,this.data,r)}return this},check_key_data:function(e){var t=JSON.stringify(this.data).length,n=proboards.data("plugin_max_key_length");if(t>n){var r=[];for(var i in this.data)r.push({ts:i,m:this.data[i].m?this.data[i].m:this.data[i],i:this.data[i].m?this.data[i].i:null});r=r.sort(function(e,t){return e.ts>t.ts?1:0});if(r.length){this.data[r[0].ts]&&(delete this.data[r[0].ts],r.shift());if(JSON.stringify(this.data).length>n)while(JSON.stringify(this.data).length>n){if(!r.length)break;delete this.data[r[0].ts],r.shift()}}r.length||(this.data={})}},get_all:function(){return this.data},get:function(e){for(var t in this.data)if(this.data[t].i!=null&&this.data[t].i==e)return this.data[t];return null},remove_all:function(){return this.data={},yootil.key.set(this.key,this.data,yootil.user.id(),!0),this},remove:function(
e){for(var t in this.data)if(this.data[t].i!=null&&this.data[t].i==e){delete this.data[t],yootil.key.set(this.key,this.data,yootil.user.id(),!0);break}return this},show:function(e){if(this.data){var t=!1;for(var n in this.data){t=!0;var r=this.data[n];r.i==null&&(r={i:n,m:r});if(this.is_in_storage(r.i))continue;yootil.notifications_queue[this.key].add($.proxy(function(t){var n=this;typeof e.before!="undefined"&&typeof e.before=="function"&&(t=e.before(t));var r=n.html_tpl.replace("{NOTIFICATION_MESSAGE}",t.m);$(r).attr("id","yootil-notification-"+t.i).appendTo($("body")).delay(200).fadeIn("normal",function(){n.add_to_storage(t.i)}).delay(3500).fadeOut("normal",function(){typeof e.after!="undefined"&&typeof e.after=="function"&&e.after(t),yootil.notifications_queue[n.key].next()})},this,r))}if(t&&this.has_local_data()){var i=yootil.location.thread()||yootil.location.editing()||yootil.location.posting(),s=yootil.location.conversation_new()||yootil.location.messaging();if(i||s){var o;i?o=yootil.form.any_posting():o=yootil.form.any_messaging(),o.length==1&&this.bind_form_submit(o)}}}return this},has_local_data:function(){var e=yootil.storage.get(this.key,!0,!0);return $.isEmptyObject(e)?!1:!0},bind_form_submit:function(e){e.bind("submit",$.proxy(this.remove_viewed_notifications,this))},remove_viewed_notifications:function(){var e=yootil.key.value(this.key,yootil.user.id()),t=yootil.storage.get(this.key,!0,!0);for(var n in t)e[n]&&delete e[n],delete t[n];yootil.key.set(this.key,e,yootil.user.id()),yootil.storage.set(this.key,t,!0,!0)},add_to_storage:function(e){var t=yootil.storage.get(this.key,!0,!0);t||(t={}),t[e]||(t[e]=1),yootil.storage.set(this.key,t,!0,!0)},remove_from_storage:function(e){var t=yootil.storage.get(this.key,!0,!0);t&&t[e]&&delete t[e],yootil.storage.set(this.key,t,!0,!0)},is_in_storage:function(e){var t=yootil.storage.get(this.key,!0,!0);return t&&t[e]?!0:!1}},e}(),yootil.sound=function(){return{audio_obj:null,play:function(e){this.audio_obj||this.create_audio_obj(),e&&(this.audio_obj.attr("src",e),this.audio_obj.get(0).play())},create_audio_obj:function(){this.audio_obj=$("<audio id='yootil_sound_player' style='display: none'></audio>"),this.audio_obj.appendTo($("body"))}}}();